# 安卓15状态栏显示修复说明

## 问题分析

应用在安卓15上打开后，系统状态栏没有正常显示，用户无法看到时间、电量等系统信息。

## 根本原因

1. **窗口设置问题**：之前使用了`setDecorFitsSystemWindows(false)`，导致内容延伸到状态栏区域
2. **状态栏颜色**：设置为透明色，在浅色主题下可能导致状态栏内容不可见
3. **系统UI可见性**：使用了全屏标志，可能隐藏了状态栏

## 修复措施

### 1. 窗口设置优化
- **移除全屏模式**：将`setDecorFitsSystemWindows(false)`改为`true`
- **确保状态栏可见**：使用`SYSTEM_UI_FLAG_VISIBLE`替代全屏标志
- **状态栏颜色**：使用主题色`colorPrimaryDark`确保可见性

### 2. 安卓15兼容性处理
```kotlin
// 安卓15状态栏显示优化
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) {
    try {
        // 确保内容不延伸到状态栏区域
        window.setDecorFitsSystemWindows(true)
        window.insetsController?.let { controller ->
            // 确保状态栏可见
            controller.show(android.view.WindowInsets.Type.statusBars())
            // 设置状态栏图标颜色为深色（适合浅色主题）
            controller.setSystemBarsAppearance(
                android.view.WindowInsetsController.APPEARANCE_LIGHT_STATUS_BARS,
                android.view.WindowInsetsController.APPEARANCE_LIGHT_STATUS_BARS
            )
        }
        // 设置状态栏背景色（使用主题主色调）
        window.statusBarColor = resources.getColor(R.color.colorPrimaryDark)
    } catch (e: Exception) {
        // 回退到兼容模式
        window.decorView.systemUiVisibility = View.SYSTEM_UI_FLAG_VISIBLE
        window.statusBarColor = resources.getColor(R.color.colorPrimaryDark)
    }
}
```

### 3. 颜色配置
使用主题定义的颜色：
- `colorPrimaryDark: #E64A19`（深橙色）
- 确保状态栏文字图标为浅色，在深色背景上清晰可见

## 兼容性说明

- **安卓4.4-14**：使用兼容的状态栏设置
- **安卓15**：使用新的WindowInsetsController API
- **所有版本**：保持主题一致性

## 验证步骤

1. 在安卓15设备上启动应用
2. 确认状态栏正常显示时间和系统图标
3. 检查状态栏颜色与主题协调
4. 测试横竖屏切换时状态栏表现
5. 验证低版本设备不受影响

## 预期效果

- ✅ 状态栏正常显示时间和系统信息
- ✅ 状态栏颜色与应用主题协调一致
- ✅ 所有安卓版本兼容性良好
- ✅ 用户界面整体美观统一